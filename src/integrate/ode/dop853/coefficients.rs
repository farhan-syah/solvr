//! DOP853 Butcher tableau coefficients.
//!
//! Reference: Hairer, NÃ¸rsett, Wanner "Solving Ordinary Differential Equations I"
//! Coefficients from scipy.integrate._ivp.dop853_coefficients

// These are published reference coefficients with intentional high precision
#![allow(clippy::excessive_precision)]

pub const N_STAGES: usize = 12;

// Node coefficients (c_i) - when to evaluate f
pub const C: [f64; N_STAGES] = [
    0.0,
    5.26001519587677318785587544488e-2,
    7.89002279381515978178381316732e-2,
    0.118350341907227396726757197510,
    0.281649658092772603273242802490,
    1.0 / 3.0,
    0.25,
    4.0 / 13.0,
    127.0 / 195.0,
    0.6,
    6.0 / 7.0,
    1.0,
];

// 8th order weights (B) - row 12 of A matrix
pub const B: [f64; N_STAGES] = [
    5.42937341165687622380535766363e-2,
    0.0,
    0.0,
    0.0,
    0.0,
    4.45031289275240888144113950566,
    1.89151789931450038304281599044,
    -5.8012039600105847814672114227,
    3.1116436695781989440891606237e-1,
    -1.52160949662516078556178806805e-1,
    2.01365400804030348374776537501e-1,
    4.47106157277725905176885569043e-2,
];

// E5 error coefficients (5th order error estimator)
pub const E5: [f64; N_STAGES + 1] = [
    0.1312004499419488073250102996e-1,
    0.0,
    0.0,
    0.0,
    0.0,
    -0.1225156446376204440720569753e1,
    -0.4957589496572501915214079952,
    0.1664377182454986536961530415e1,
    -0.3503288487499736816886487290,
    0.3341791187130174790297318841,
    0.8192320648511571246570742613e-1,
    -0.2235530786388629525884427845e-1,
    0.0,
];

// E3 error coefficients (3rd order error estimator)
pub const E3: [f64; N_STAGES + 1] = [
    5.42937341165687622380535766363e-2 - 0.244094488188976377952755905512,
    0.0,
    0.0,
    0.0,
    0.0,
    4.45031289275240888144113950566,
    1.89151789931450038304281599044,
    -5.8012039600105847814672114227,
    3.1116436695781989440891606237e-1 - 0.733846688281611857341361741547,
    -1.52160949662516078556178806805e-1,
    2.01365400804030348374776537501e-1,
    4.47106157277725905176885569043e-2 - 0.220588235294117647058823529412e-1,
    0.0,
];

// A matrix coefficients (stored as row vectors for non-zero entries)

// Stage 2: A[1,0]
pub const A2: [f64; 1] = [5.26001519587677318785587544488e-2];

// Stage 3: A[2,0:2]
pub const A3: [f64; 2] = [
    1.97250569845378994544595329183e-2,
    5.91751709536136983633785987549e-2,
];

// Stage 4: A[3,0], A[3,2]
pub const A4_0: f64 = 2.95875854768068491816892993775e-2;
pub const A4_2: f64 = 8.87627564304205475450678981324e-2;

// Stage 5: A[4,0], A[4,2:4]
pub const A5_0: f64 = 2.41365134159266685502369798665e-1;
pub const A5_2: f64 = -8.84549479328286085344864962717e-1;
pub const A5_3: f64 = 9.24834003261792003115737966543e-1;

// Stage 6: A[5,0], A[5,3:5]
pub const A6_0: f64 = 3.7037037037037037037037037037e-2;
pub const A6_3: f64 = 1.70828608729473871279604482173e-1;
pub const A6_4: f64 = 1.25467687566822425016691814123e-1;

// Stage 7: A[6,0], A[6,3:6]
pub const A7_0: f64 = 3.7109375e-2;
pub const A7_3: f64 = 1.70252211019544039314978060272e-1;
pub const A7_4: f64 = 6.02165389804559606850219397283e-2;
pub const A7_5: f64 = -1.7578125e-2;

// Stage 8: A[7,0], A[7,3:7]
pub const A8_0: f64 = 3.70920001185047927108779319836e-2;
pub const A8_3: f64 = 1.70383925712239993810214054705e-1;
pub const A8_4: f64 = 1.07262030446373284651809199168e-1;
pub const A8_5: f64 = -1.53194377486244017527936158236e-2;
pub const A8_6: f64 = 8.27378916381402288758473766002e-3;

// Stage 9: A[8,0], A[8,3:8]
pub const A9_0: f64 = 6.24110958716075717114429577812e-1;
pub const A9_3: f64 = -3.36089262944694129406857109825;
pub const A9_4: f64 = -8.68219346841726006818189891453e-1;
pub const A9_5: f64 = 2.75920996994467083049415600797e1;
pub const A9_6: f64 = 2.01540675504778934086186788979e1;
pub const A9_7: f64 = -4.34898841810699588477366255144e1;

// Stage 10: A[9,0], A[9,3:9]
pub const A10_0: f64 = 4.77662536438264365890433908527e-1;
pub const A10_3: f64 = -2.48811461997166764192642586468;
pub const A10_4: f64 = -5.90290826836842996371446475743e-1;
pub const A10_5: f64 = 2.12300514481811942347288949897e1;
pub const A10_6: f64 = 1.52792336328824235832596922938e1;
pub const A10_7: f64 = -3.32882109689848629194453265587e1;
pub const A10_8: f64 = -2.03312017085086261358222928593e-2;

// Stage 11: A[10,0], A[10,3:10]
pub const A11_0: f64 = -9.3714243008598732571704021658e-1;
pub const A11_3: f64 = 5.18637242884406370830023853209;
pub const A11_4: f64 = 1.09143734899672957818500254654;
pub const A11_5: f64 = -8.14978701074692612513997267357;
pub const A11_6: f64 = -1.85200656599969598641566180701e1;
pub const A11_7: f64 = 2.27394870993505042818970056734e1;
pub const A11_8: f64 = 2.49360555267965238987089396762;
pub const A11_9: f64 = -3.0467644718982195003823669022;

// Stage 12: A[11,0], A[11,3:11]
pub const A12_0: f64 = 2.27331014751653820792359768449;
pub const A12_3: f64 = -1.05344954667372501984066689879e1;
pub const A12_4: f64 = -2.00087205822486249909675718444;
pub const A12_5: f64 = -1.79589318631187989172765950534e1;
pub const A12_6: f64 = 2.79488845294199600508499808837e1;
pub const A12_7: f64 = -2.85899827713502369474065508674;
pub const A12_8: f64 = -8.87285693353062954433549289258;
pub const A12_9: f64 = 1.23605671757943030647266201528e1;
pub const A12_10: f64 = 6.43392746015763530355970484046e-1;
